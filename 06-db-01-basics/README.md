# Домашнее задание к занятию 1. «Типы и структура СУБД»

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/virt-11/additional).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определённых данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- электронные чеки в json-виде,
- склады и автомобильные дороги для логистической компании,
- генеалогические деревья,
- кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации,
- отношения клиент-покупка для интернет-магазина.

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Ответ 1

Для различных типов данных, можно использовать следующие типы СУБД:
1. Электронные чеки в JSON-виде:
Для хранения электронных чеков в формате JSON можно использовать NoSQL базу данных, такую как MongoDB. Такие БД хорошо подходят для хранения документоориентированных данных, так как JSON обладает гибкой структурой и может быть легко хранить и извлекать в БД без жесткой схемы.
2. Склады и автомобильные дороги для логистической компании:
Для хранения данных о складах и автомобильных дорогах, которые имеют простую и четкую структуру, рекомендуется использовать реляционную базу данных, например PostgreSQL или MySQL. Реляционные БД обеспечивают надежность, целостность данных и поддерживают гибкую схему, что может быть полезно при модификации или расширении моделей данных.
3. Генеалогические деревья:
Для хранения данных генеалогических деревьев можно использовать графовую базу данных, такую как Neo4j. Графовые базы данных оптимизированы для работы с связями между объектами и могут легко представлять сложные отношения. Графовые БД предоставляют мощные инструменты для выполнения запросов, поиска путей между узлами и анализа связей в графе.
4. Кэш идентификаторов клиентов с ограниченным временем жизни:
Для хранения временных данных, таких как кэш идентификаторов клиентов с ограниченным временем жизни, можно использовать in-memory базу данных, например Redis. In-memory БД хранят данные в оперативной памяти, что обеспечивает быстрый доступ к данным. Redis также предоставляет механизмы управления временем жизни данных, что позволяет автоматически удалять устаревшие записи.
5. Отношения клиент-покупка для интернет-магазина:
Для хранения отношений клиент-покупка в интернет-магазине можно использовать реляционную БД, такую как PostgreSQL или MySQL. Реляционные БД хорошо подходят для хранения и обработки связей между объектами и обеспечивают надежность, целостность данных и возможность выполнения мощных запросов.
Выбор конкретной типа СУБД будет зависеть от специфических требований проекта, ожиданий обработки данных и других факторов.

## Задача 2

Вы создали распределённое высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт — это отдельная реализация вашей системы и для каждого пункта нужно привести классификацию):

- данные записываются на все узлы с задержкой до часа (асинхронная запись);
- при сетевых сбоях система может разделиться на 2 раздельных кластера;
- система может не прислать корректный ответ или сбросить соединение.

Согласно PACELC-теореме как бы вы классифицировали эти реализации?

## Ответ 2

Согласно CAP-теореме, систему можно классифицировать по следующим критериям:
1. Асинхронная запись:
В случае, когда данные записываются на все узлы с задержкой до часа, система удовлетворяет критерию доступности (A) и согласованности (C), но не гарантирует отказоустойчивость в случае сетевых сбоев. Поэтому данная реализация может быть классифицирована как CP - гарантирует согласованность и доступность, но жертвует отказоустойчивостью.
2. Разделение на кластеры при сетевых сбоях:
В случае, когда система может разделиться на два раздельных кластера в результате сетевых сбоев, она обеспечивает отказоустойчивость (P) и доступность (A), но не может гарантировать согласованность (C) между разделенными кластерами. Такая реализация может быть классифицирована как AP - обеспечивает отказоустойчивость и доступность, но не гарантирует согласованность при разделении кластеров.
3. Возможность некорректного ответа или сброса соединения:
В случае, когда система может не прислать корректный ответ или сбросить соединение, она может обеспечивать доступность (A), но не гарантирует согласованность (C) и отказоустойчивость (P). Такая реализация может быть классифицирована как AP - обеспечивает доступность, но не гарантирует согласованность или отказоустойчивость.
Согласно PACELC-теореме, классификация данных реализаций выглядит следующим образом:
1. Асинхронная запись: CP
2. Разделение на кластеры при сетевых сбоях: AP
3. Возможность некорректного ответа или сброса соединения: AP

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

## Ответ 3

Принципы BASE и ACID являются двумя разными философиями для проектирования и обеспечения надежности распределенных систем.

* ACID является традиционным подходом, где основной упор делается на согласованность данных и гарантии транзакционной целостности. ACID-транзакции гарантируют атомарность, согласованность, изоляцию и долговечность данных. Этот подход обычно используется в традиционных реляционных базах данных, где согласованность данных имеет высший приоритет над доступностью.
* BASE уделяет больший приоритет доступности и масштабируемости системы, жертвуя некоторой степенью согласованности данных. BASE-системы стремятся обеспечить базовую доступность (basically available), мягкое состояние (soft state) и постепенную согласованность данных (eventually consistent). Они обычно используются в распределенных системах, где высокая доступность и масштабируемость являются приоритетами, даже если некоторые узлы могут быть временно несогласованными.
Таким образом, принципы BASE и ACID представляют разные философии обработки данных в распределенных системах. Они имеют разные приоритеты и оптимизируют системы под разные характеристики и требования. Хотя теоретически возможно сочетание некоторых аспектов BASE и ACID в одной системе, на практике подходы обычно противоположны друг другу. Это либо сводит систему к одному из подходов, либо требует сложной балансировки и компромиссов между требованиями к доступности, согласованности и надежности данных.

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни,
- реакция на истечение таймаута.

Вы слышали о key-value-хранилище, которое имеет механизм Pub/Sub. 
Что это за система? Какие минусы выбора этой системы?

## Ответ 4
Key-value хранилище с механизмом Pub/Sub (Publish/Subscribe) это система, которая обеспечивает хранение данных в формате пар "ключ-значение", и предоставляет возможность асинхронной доставки сообщений по подписке на определенные события или топики.
В такой системе есть две основные роли: издатель (publisher) и подписчик (subscriber). Издатель отправляет сообщения с определенным ключом (ключами) в хранилище, а подписчики подписываются на ключи или топики, чтобы получать уведомления о новых сообщениях, соответствующих их интересам.
Преимущества использования key-value хранилища с механизмом Pub/Sub включают:
1. Гибкость и масштабируемость: Такая система позволяет гибко настраивать подписки на определенные ключи или топики, что позволяет эффективно обрабатывать разные типы данных и интересы пользователей.
2. Асинхронность: Pub/Sub механизм позволяет асинхронно доставлять сообщения подписчикам. Это делает систему отзывчивой и способной обрабатывать большие объемы данных без блокировки.
3. Распределенная архитектура: Key-value хранилище с Pub/Sub механизмом обычно работает в распределенной среде, что обеспечивает высокую доступность и надежность системы. 
Однако, при выборе такой системы учитывайте следующие минусы:
1. Консистентность данных: Key-value хранилище с Pub/Sub механизмом может не давать сильной гарантии согласованности данных. Возможны ситуации, когда подписчик получит сообщение до того, как оно будет полностью записано в хранилище, или сообщение может быть потеряно, если произойдет сбой до доставки. 
2. Сложность разработки: Использование Pub/Sub механизма требует дополнительной логики на стороне клиента для управления подписками и обработки сообщений. Это может усложнить разработку и поддержку системы, особенно в случае сложных сценариев взаимодействия между издателями и подписчиками.
3. Отказоустойчивость: Хотя распределенная архитектура обеспечивает повышенную отказоустойчивость, возможны ситуации, когда система может быть недоступна или сообщения могут быть потеряны при сбоях.
В конечном счете, выбор key-value хранилища с механизмом Pub/Sub зависит от требований и особенностей конкретной системы. Необходимо тщательно оценить свои потребности и понять, насколько данные минусы могут повлиять на архитектуру и надежность вашей системы.

---

### Как cдавать задание

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---

